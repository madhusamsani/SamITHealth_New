<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SamITHealth — Claims Management Dashboard</title>
  <meta name="description" content="Claims Management & TPA Support — end-to-end claim lifecycle management, rule-based adjudication, and TPA integration." />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    :root{
      --bg:#f4f7fb;
      --paper:#ffffff;
      --muted:#586674;
      --brand:#07203b;
      --accent:#0066ff;
      --accent-2:#0047d1;
      --teal:#0aa89e;
      --success:#10b981;
      --danger:#ef4444;
      --max:1200px;
      --radius:12px;
      --shadow:0 12px 40px rgba(6,18,45,0.06);
      --social-size:44px;
      --gap:20px;
      font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#fff);color:var(--brand);-webkit-font-smoothing:antialiased}
    a{color:var(--accent);text-decoration:none}
    img{max-width:100%;display:block}

    .wrap{max-width:var(--max);margin:28px auto;padding:0 20px}

    /* Header: provider-services alignment */
    header.site-header{background:#fff;border-bottom:1px solid #e6eef6;position:sticky;top:0;z-index:90}
    .header-inner{max-width:var(--max);margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:14px 20px;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo-mark{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:18px}
    .brand-text{display:flex;flex-direction:column}
    .brand-text .title{font-weight:800;font-size:18px;color:var(--brand)}
    .brand-text .tag{font-size:12px;color:var(--muted)}
    nav.primary{display:flex;gap:12px;align-items:center}
    nav.primary a{padding:8px 12px;border-radius:8px;color:var(--muted);font-weight:600}
    nav.primary a.active{background:rgba(0,102,255,0.06);color:var(--accent-2)}
    .header-ctas{display:flex;gap:12px;align-items:center}
    .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;padding:10px 14px;border-radius:10px;border:0;font-weight:700;cursor:pointer}

    /* Layout */
    .container{max-width:var(--max);margin:28px auto;padding:20px}
    header.page-header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    header.page-header .logo-mini{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--teal));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    .longlist{display:flex;flex-direction:column;gap:12px}
    .card{background:var(--paper);border-radius:var(--radius);padding:14px;box-shadow:var(--shadow)}
    .card h3{margin:0;font-size:14px;color:var(--brand)}
    .card .muted{font-size:12px;color:var(--muted);margin-top:6px}
    .viz{min-height:180px;display:flex;flex-direction:column;gap:10px}
    canvas{width:100% !important;max-height:260px}

    /* Right column styles */
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .kpi-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    .kpi{padding:10px;border-radius:10px;background:linear-gradient(180deg,#eef6ff,#fff);}
    .kpi .value{font-weight:700;font-size:18px}
    .kpi .label{font-size:12px;color:var(--muted)}

    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{padding:8px;text-align:left;border-bottom:1px solid #eef2f7}
    th{font-size:12px;color:var(--muted)}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px}
    .badge.ok{background:rgba(16,185,129,0.12);color:var(--success)}
    .badge.warn{background:rgba(250,204,21,0.12);color:#b45309}
    .badge.err{background:rgba(239,68,68,0.12);color:var(--danger)}

    .controls{display:flex;gap:8px;align-items:center}
    .search{flex:1;padding:8px;border-radius:8px;border:1px solid #e6eef2}
    button.btn{background:var(--brand);color:white;padding:8px 12px;border-radius:8px;border:none;cursor:pointer}
    .small{padding:6px 10px;font-size:13px}

    /* Footer - provider-services style */
    footer.site-footer{background:var(--brand);color:#e6eefc;padding:48px 20px 36px;margin-top:36px}
    .footer-inner{max-width:var(--max);margin:0 auto;display:grid;grid-template-columns:1fr 320px;gap:24px;align-items:start}
    .footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:36px}
    .footer-logo{height:60px;margin-bottom:10px;display:block;border-radius:8px}
    .footer-content h4{color:#e6eefc;font-size:16px;margin-bottom:8px}
    .footer-content p, .footer-content a{color:rgba(230,238,252,0.95);font-size:15px;line-height:1.6;margin:6px 0}
    .socials{display:flex;gap:12px}
    .socials a{display:inline-flex;align-items:center;justify-content:center;width:var(--social-size);height:var(--social-size);border-radius:10px;color:#fff;text-decoration:none;box-shadow:0 8px 24px rgba(2,6,23,0.12)}
    .socials a svg{width:18px;height:18px;fill:#fff;display:block}
    .socials a.linkedin{background:#0A66C2}
    .socials a.twitter{background:#1DA1F2}
    .socials a.youtube{background:#FF0000}
    .footer-newsletter{max-width:320px;text-align:right;color:rgba(230,238,252,0.9)}
    .footer-newsletter input{padding:10px;border-radius:8px;border:0;min-width:0;margin-right:8px}
    .footer-bottom{border-top:1px solid rgba(255,255,255,0.06);margin-top:24px;padding-top:18px;font-size:14px;color:rgba(230,238,252,0.75);text-align:center}

    .home-fab{position:fixed;right:18px;bottom:18px;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;text-decoration:none;box-shadow:0 12px 36px rgba(2,6,23,0.18);z-index:200}

    @media(max-width:980px){
      .grid{grid-template-columns:1fr}
      .header-inner{flex-direction:column;align-items:flex-start;gap:12px}
      nav.primary{flex-wrap:wrap}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Header: SH icon + SamITHealth linking to home; aligned like provider-services -->
    <header class="site-header" role="banner" aria-label="Main header">
      <div class="header-inner">
        <a href="index.html" class="brand" aria-label="Go to SamITHealth home page">
          <div class="logo-mark" aria-hidden="true">SH</div>
          <div class="brand-text">
            <div class="title">SamITHealth</div>
            <div class="tag">Claims Management</div>
          </div>
        </a>

        <nav class="primary" role="navigation" aria-label="Main navigation">
          <a href="index.html">Home</a>
          <a href="provider-services.html">Provider Services</a>
          <a href="claims-management.html" class="active">Claims</a>
          <a href="medical-review.html">Medical Review</a>
          <a href="contact.html">Contact</a>
        </nav>

        <div class="header-ctas" aria-hidden="false">
          <!-- phone intentionally removed on this page -->
          <button class="btn-primary" onclick="location.href='contact.html'">Get Support</button>
        </div>
      </div>
    </header>

    <main class="container">
      <header class="page-header">
        <div class="logo-mini" style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--teal));display:flex;align-items:center;justify-content:center;color:white;font-weight:700">CM</div>
        <div>
          <h1 style="margin:0;font-size:20px">Claims Management — SamITHealth</h1>
          <p class="muted" style="margin:6px 0 0;font-size:13px">Claims Management &amp; TPA Support — end-to-end claim lifecycle, rule-based adjudication, and third‑party administrator integrations.</p>
        </div>
      </header>

      <div class="grid" role="main">
        <!-- left column: long-listed visualizations -->
        <main class="longlist" aria-label="Claims visualizations">

          <section class="card" aria-labelledby="claims-volume">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <h3 id="claims-volume">1. Claims Volume (30 days)</h3>
                <div class="muted">Daily submitted vs adjudicated</div>
              </div>
              <div class="controls">
                <select id="cv-range" class="small" aria-label="Claims volume range">
                  <option value="30">Last 30 days</option>
                  <option value="90">Last 90 days</option>
                  <option value="365">Last 12 months</option>
                </select>
                <button class="btn small" onclick="downloadCSV('claims_volume')">CSV</button>
              </div>
            </div>
            <div class="viz"><canvas id="chart-claims-volume" aria-label="Claims volume chart"></canvas></div>
          </section>

          <section class="card" aria-labelledby="claim-funnel">
            <h3 id="claim-funnel">2. Claim Lifecycle Funnel</h3>
            <div class="muted">Submission → Validation → Adjudication → Payment / Denial</div>
            <div class="viz"><canvas id="chart-funnel" aria-label="Claim funnel chart"></canvas></div>
          </section>

          <section class="card" aria-labelledby="rule-adjudication">
            <h3 id="rule-adjudication">3. Rule-based Adjudication Results</h3>
            <div class="muted">Rules fired, auto-adjudicated, manual review required</div>
            <div class="viz"><canvas id="chart-rules" aria-label="Rule adjudication chart"></canvas></div>
          </section>

          <section class="card" aria-labelledby="denials">
            <h3 id="denials">4. Top 6 Denial Reasons (Long list)</h3>
            <div class="muted">Bar chart showing frequent denial categories</div>
            <div class="viz"><canvas id="chart-denials" aria-label="Denials chart"></canvas></div>
          </section>

          <section class="card" aria-labelledby="aht">
            <h3 id="aht">5. Average Handling Time by TPA</h3>
            <div class="muted">Avg business hours from submission to closure</div>
            <div class="viz"><canvas id="chart-aht" aria-label="Average handling time chart"></canvas></div>
          </section>

          <section class="card" aria-labelledby="recent-claims">
            <h3 id="recent-claims">6. Recent Claims (Long list)</h3>
            <div class="muted">Most recent claims with quick actions</div>
            <div style="margin-top:8px;overflow:auto;max-height:220px">
              <table aria-label="Recent claims">
                <thead><tr><th>Claim ID</th><th>Patient</th><th>TPA</th><th>Status</th><th>Amount</th><th></th></tr></thead>
                <tbody id="recent-claims-body"></tbody>
              </table>
            </div>
          </section>

        </main>

        <!-- right column: KPIs and TPA status -->
        <aside class="sidebar" aria-label="Sidebar KPIs and actions">
          <div class="card" aria-labelledby="overview-kpis">
            <h3 id="overview-kpis">Overview KPIs</h3>
            <div class="kpi-grid" style="margin-top:10px">
              <div class="kpi"><div class="value" id="kpi-submitted">—</div><div class="label">Submitted (30d)</div></div>
              <div class="kpi"><div class="value" id="kpi-adjudicated">—</div><div class="label">Adjudicated (30d)</div></div>
              <div class="kpi"><div class="value" id="kpi-autorule">—</div><div class="label">Auto-adjudicated %</div></div>
              <div class="kpi"><div class="value" id="kpi-denialrate">—</div><div class="label">Denial rate</div></div>
            </div>
          </div>

          <div class="card" aria-labelledby="tpa-integrations">
            <h3 id="tpa-integrations">TPA Integrations</h3>
            <div class="muted">Real-time status for connected third-party administrators</div>
            <table style="margin-top:8px">
              <thead><tr><th>TPA</th><th>Status</th></tr></thead>
              <tbody id="tpa-status"></tbody>
            </table>
          </div>

          <div class="card" aria-labelledby="rule-engine">
            <h3 id="rule-engine">Rule Engine Snapshot</h3>
            <div class="muted">Top rules fired in last 24 hours</div>
            <ol id="top-rules" style="margin-top:10px;padding-left:18px"></ol>
          </div>

          <div class="card" aria-labelledby="actions">
            <h3 id="actions">Actions</h3>
            <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
              <button class="btn" onclick="simulateRefresh()">Refresh Data</button>
              <button class="btn" style="background:transparent;color:var(--brand);border:1px solid #e6eef2" onclick="openSettings()">Settings</button>
            </div>
          </div>

        </aside>
      </div>
    </main>

    <!-- Footer: provider-services style (logo, description, explore links, socials, newsletter). Phone removed for this page. -->
    <footer class="site-footer" role="contentinfo" aria-label="Footer">
      <div class="footer-inner">
        <div class="footer-content">
          <div>
            <a href="index.html" aria-label="SamITHealth home (logo)">
              <img class="footer-logo" src="https://images.unsplash.com/photo-1503676260728-1c00da094a0b?q=80&w=600&auto=format&fit=crop" alt="SamITHealth Logo">
            </a>
            <p>Data-driven repricing, clinical review and provider engagement to contain costs and ensure fair pricing.</p>
          </div>

          <div>
            <h4>Explore</h4>
            <a href="provider-services.html">Provider Services</a><br>
            <a href="rcm-solutions.html">RCM Solutions</a><br>
            <a href="payer-solutions.html">Payer Solutions</a><br>
            <a href="consultancy.html">Consultancy</a>
          </div>
        </div>

        <div style="display:flex;flex-direction:column;gap:12px;align-items:flex-end">
          <nav class="socials" aria-label="Social media">
            <a class="linkedin" href="https://www.linkedin.com" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn — SamITHealth" title="LinkedIn">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4.98 3.5C4.98 4.88 3.87 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM0 8h5v14H0V8zm7.5 0h4.7v1.9h.1c.7-1.2 2.5-2.5 5.1-2.5 5.5 0 6.8 3.6 6.8 8.3V22h-5v-6.7c0-1.6 0-3.8-2.4-3.8-2.4 0-2.8 1.9-2.8 3.7V22h-5V8z"/></svg>
            </a>

            <a class="twitter" href="https://twitter.com" target="_blank" rel="noopener noreferrer" aria-label="Twitter — SamITHealth" title="Twitter">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53A4.48 4.48 0 0 0 12 7v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/></svg>
            </a>

            <a class="youtube" href="https://youtube.com" target="_blank" rel="noopener noreferrer" aria-label="YouTube — SamITHealth" title="YouTube">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M23.5 6.2s-.2-1.7-.8-2.4c-.8-.9-1.7-.9-2.1-1C16.8 2.3 12 2.3 12 2.3h-.1s-4.8 0-8.5.5c-.4 0-1.3.1-2.1 1-.6.7-.8 2.4-.8 2.4S0 8 0 9.9v1.9C0 13 0 14.5.6 15.8c.5 1.1 1.2 1.6 2.3 1.7 1.7.2 7.6.5 7.6.5s4.5 0 8.4-.5c.5 0 1.4-.1 2.1-1 .6-1 1-2.6 1-4.4V9.9c0-.1 0-.1 0-.1zM9.8 13.4V7.4l5.1 3-5.1 3z"/></svg>
            </a>
          </nav>

          <div class="footer-newsletter" aria-label="Newsletter sign up">
            <div>Subscribe to our repricing newsletter for provider engagement best practices.</div>
            <form style="margin-top:8px;display:flex;gap:8px;justify-content:flex-end" action="#" onsubmit="event.preventDefault();alert('Thank you — form submission is disabled in this mockup.')">
              <input aria-label="Email" placeholder="Email address" type="email" required style="padding:10px;border-radius:8px;border:0;min-width:0">
              <button class="btn-primary" type="submit">Subscribe</button>
            </form>
          </div>
        </div>
      </div>

      <div class="footer-bottom">© 2025 SamITHealth. All rights reserved.</div>
    </footer>

    <!-- Floating quick-home button -->
    <a class="home-fab" href="index.html" aria-label="Back to home">SH</a>
  </div>

  <script>
    // Simple demo data generation and Chart.js wiring (self-contained)
    const now = new Date();

    function genDailySeries(days){
      const out=[];
      for(let i=days-1;i>=0;i--){
        const d=new Date();
        d.setDate(now.getDate()-i);
        const date = d.toISOString().slice(0,10);
        const submitted = Math.round(200 + Math.random()*140);
        const adjudicated = Math.max(0, submitted - Math.round(Math.random()*60));
        out.push({date, submitted, adjudicated});
      }
      return out;
    }

    let claims30 = genDailySeries(30);

    function computeKPIs(series){
      const submitted = series.reduce((s,r)=>s+r.submitted,0);
      const adjudicated = series.reduce((s,r)=>s+r.adjudicated,0);
      const autoPct = submitted ? Math.round((adjudicated/submitted)*100) : 0;
      const denialRate = submitted ? Math.round((1 - adjudicated/submitted)*100) : 0;
      return {submitted,adjudicated,autoPct,denialRate};
    }

    // Claims Volume (stacked bars)
    const ctxCV = document.getElementById('chart-claims-volume').getContext('2d');
    const claimsVolumeChart = new Chart(ctxCV, {
      type: 'bar',
      data: {
        labels: claims30.map(r=>r.date),
        datasets: [
          { label:'Submitted', data: claims30.map(r=>r.submitted), backgroundColor: 'rgba(6,86,255,0.8)' },
          { label:'Adjudicated', data: claims30.map(r=>r.adjudicated), backgroundColor: 'rgba(10,168,158,0.85)' }
        ]
      },
      options: { responsive:true, plugins:{legend:{position:'top'}} }
    });

    // Funnel (horizontal stacked)
    const ctxF = document.getElementById('chart-funnel').getContext('2d');
    const funnelChart = new Chart(ctxF, {
      type: 'bar',
      data: {
        labels: ['Funnel'],
        datasets: [
          { label:'Submission', data:[1000], backgroundColor:'rgba(10,168,158,0.9)' },
          { label:'Validation', data:[820], backgroundColor:'rgba(6,86,255,0.85)' },
          { label:'Adjudication', data:[650], backgroundColor:'rgba(99,102,241,0.9)' },
          { label:'Payment', data:[540], backgroundColor:'rgba(16,185,129,0.9)' }
        ]
      },
      options: { indexAxis: 'y', plugins:{legend:{position:'bottom'}}, scales:{x:{stacked:true},y:{stacked:true}} }
    });

    // Rules (doughnut)
    const ctxR = document.getElementById('chart-rules').getContext('2d');
    const rulesChart = new Chart(ctxR, {
      type: 'doughnut',
      data: { labels:['Auto-pass','Auto-deny','Manual-review'], datasets:[{ data:[58,12,30], backgroundColor:['rgba(10,168,158,0.9)','rgba(239,68,68,0.9)','rgba(99,102,241,0.9)'] }] },
      options: { responsive:true, plugins:{legend:{position:'bottom'}} }
    });

    // Denials (bar)
    const ctxD = document.getElementById('chart-denials').getContext('2d');
    const denialsData = { labels:['Missing info','Pre-existing','Policy limit','Coding error','Eligibility','Other'], values:[120,95,70,55,40,24] };
    const denialsChart = new Chart(ctxD, {
      type: 'bar',
      data: { labels: denialsData.labels, datasets:[{ label:'Denials', data: denialsData.values, backgroundColor: denialsData.values.map((v,i)=>['rgba(10,168,158,0.9)','rgba(239,68,68,0.9)','rgba(99,102,241,0.9)','rgba(250,204,21,0.9)','rgba(6,86,255,0.9)','rgba(120,121,140,0.9)'][i]) }]},
      options: { responsive:true, plugins:{legend:{display:false}}}
    });

    // AHT (bar)
    const ctxA = document.getElementById('chart-aht').getContext('2d');
    const tpas = ['TPA One','TPA Two','TPA Three','TPA Four'];
    const aht = [48,72,36,60];
    const ahtChart = new Chart(ctxA, {
      type: 'bar',
      data: { labels: tpas, datasets:[{ label:'Avg hours', data: aht, backgroundColor: ['rgba(10,168,158,0.9)','rgba(99,102,241,0.9)','rgba(6,86,255,0.9)','rgba(16,185,129,0.9)'] }]},
      options: { responsive:true, plugins:{legend:{display:false}} }
    });

    // Recent claims (table) and supporting lists
    const recentClaims = Array.from({length:16}).map((_,i)=>{
      const id = `CLM-${2025000+i}`;
      const patient = `Patient ${i+1}`;
      const tpa = tpas[i % tpas.length];
      const statuses = ['Submitted','Adjudicated','Denied','Manual Review'];
      const status = statuses[Math.floor(Math.random()*statuses.length)];
      const amount = (Math.round((200 + Math.random()*480) * 100)/100).toLocaleString();
      return { id, patient, tpa, status, amount };
    });

    function formatStatus(s){
      if(s==='Adjudicated') return '<span class="badge ok">Adjudicated</span>';
      if(s==='Denied') return '<span class="badge err">Denied</span>';
      if(s==='Manual Review') return '<span class="badge warn">Manual</span>';
      return '<span class="badge" style="background:#eef2f7;color:var(--muted)">Submitted</span>';
    }

    function renderRecent(){
      const tbody = document.getElementById('recent-claims-body'); tbody.innerHTML = '';
      recentClaims.forEach(c=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${c.id}</td><td>${c.patient}</td><td>${c.tpa}</td><td>${formatStatus(c.status)}</td><td>${c.amount}</td><td><button class="small" onclick="openClaim('${c.id}')">Open</button></td>`;
        tbody.appendChild(tr);
      });
    }

    // TPA status
    const tpaStatus = [
      {name:'TPA One', status:'OK'},
      {name:'TPA Two', status:'Degraded'},
      {name:'TPA Three', status:'OK'},
      {name:'TPA Four', status:'Offline'}
    ];
    function renderTPA(){
      const tbody = document.getElementById('tpa-status'); tbody.innerHTML = '';
      tpaStatus.forEach(t=>{
        const tr = document.createElement('tr');
        const s = t.status==='OK' ? '<span class="badge ok">OK</span>' : (t.status==='Degraded' ? '<span class="badge warn">Degraded</span>' : '<span class="badge err">Offline</span>');
        tr.innerHTML = `<td>${t.name}</td><td>${s}</td>`;
        tbody.appendChild(tr);
      });
    }

    // Top rules
    const rulesList = ['Duplicate detection','Policy eligibility','Pre-auth check','Coding validation','Provider contract check','Fraud pattern scan'];
    function renderTopRules(){
      const ol = document.getElementById('top-rules'); ol.innerHTML = '';
      rulesList.slice(0,6).forEach(r=>{ const li = document.createElement('li'); li.textContent = r; ol.appendChild(li); });
    }

    // KPIs
    function renderKPIs(){
      const k = computeKPIs(claims30);
      document.getElementById('kpi-submitted').textContent = k.submitted.toLocaleString();
      document.getElementById('kpi-adjudicated').textContent = k.adjudicated.toLocaleString();
      document.getElementById('kpi-autorule').textContent = k.autoPct + '%';
      document.getElementById('kpi-denialrate').textContent = k.denialRate + '%';
    }

    // Interactions
    function openClaim(id){ alert('Open claim: ' + id + ' — (would open claim detail in product)'); }
    function openSettings(){ alert('Open Settings — configuration for rules, TPA keys, export, etc.'); }

    function simulateRefresh(){
      // mutate data and update charts to simulate refresh
      claims30.forEach(r => { r.adjudicated = Math.max(0, r.submitted - Math.round(Math.random()*60)); });
      claimsVolumeChart.data.datasets[0].data = claims30.map(r=>r.submitted);
      claimsVolumeChart.data.datasets[1].data = claims30.map(r=>r.adjudicated);
      claimsVolumeChart.update();

      denialsChart.data.datasets[0].data = denialsData.values.map(d => Math.max(5, d + Math.round((Math.random()-0.5)*30)));
      denialsChart.update();

      ahtChart.data.datasets[0].data = aht.map(a=>Math.max(10, Math.round(a + (Math.random()-0.5)*20)));
      ahtChart.update();

      renderRecent(); renderTPA(); renderTopRules(); renderKPIs();
      document.querySelector('.footer-bottom')?.textContent && setTimeout(()=>{},0);
    }

    function downloadCSV(key){
      let csv = '';
      if(key === 'claims_volume'){
        csv = 'date,submitted,adjudicated\n' + claims30.map(r=>`${r.date},${r.submitted},${r.adjudicated}`).join('\n');
      }
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = key + '.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }

    // Initial render
    renderRecent(); renderTPA(); renderTopRules(); renderKPIs();

    // Range selector: regenerate series when changed
    document.getElementById('cv-range').addEventListener('change', (e)=>{
      const days = parseInt(e.target.value,10);
      claims30 = genDailySeries(days);
      claimsVolumeChart.data.labels = claims30.map(r=>r.date);
      claimsVolumeChart.data.datasets[0].data = claims30.map(r=>r.submitted);
      claimsVolumeChart.data.datasets[1].data = claims30.map(r=>r.adjudicated);
      claimsVolumeChart.update();
      renderKPIs();
    });

    // Accessibility: '/' focuses search if exists
    document.addEventListener('keydown', e => { if(e.key === '/') { document.querySelector('.search')?.focus(); e.preventDefault(); } });
  </script>
</body>
</html>