<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SamITHealth — Form Conversion & Interoperability</title>
  <meta name="description" content="Form Conversion & Interoperability — automated CMS-1500/UB-04 conversion, EDI mapping, and system harmonization." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    /* preserve original core visuals (so charts/data keep same look) */
    :root{
      --navy:#0b2545;
      --teal:#0aa89e;
      --muted:#6b7280;
      --bg:#f7fafc;
      --card:#fff;
      --accent-2:#e6f7f5;
      --danger:#ef4444;
      --success:#10b981;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#fff);color:var(--navy);-webkit-font-smoothing:antialiased}
    .container{max-width:1200px;margin:28px auto;padding:20px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:18px}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(11,37,69,0.06)}
    .longlist{display:flex;flex-direction:column;gap:12px}
    .viz{min-height:160px;display:flex;flex-direction:column;gap:10px}
    canvas{width:100% !important;max-height:260px}
    .kpi-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}
    .kpi{padding:10px;border-radius:10px;background:linear-gradient(180deg,var(--accent-2),#fff)}
    .kpi .value{font-weight:700;font-size:18px}
    .kpi .label{font-size:12px;color:var(--muted)}
    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{padding:8px;text-align:left;border-bottom:1px solid #eef2f7}
    th{font-size:12px;color:var(--muted)}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px}
    .badge.ok{background:rgba(16,185,129,0.12);color:var(--success)}
    .badge.warn{background:rgba(250,204,21,0.12);color:#b45309}
    .badge.err{background:rgba(239,68,68,0.12);color:var(--danger)}
    .controls{display:flex;gap:8px;align-items:center}
    .small{padding:6px 10px;font-size:13px}
    button.btn{background:var(--navy);color:white;padding:8px 12px;border-radius:8px;border:none;cursor:pointer}
    footer.small-sync{margin-top:18px;color:var(--muted);font-size:12px}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}

    /* --- Header/Footer visuals: adapt from provider-services.html to align exactly --- */
    :root{
      --ps-bg:#f4f7fb;
      --ps-paper:#ffffff;
      --ps-muted:#586674;
      --ps-brand:#07203b;
      --ps-accent:#0066ff;
      --ps-accent-2:#0047d1;
      --ps-max:1200px;
      --ps-radius:12px;
      --ps-shadow:0 12px 40px rgba(6,18,45,0.06);
      --ps-social-size:44px;
    }

    /* Header matching provider-services layout */
    header.site-header{background:#fff;border-bottom:1px solid #e6eef6;position:sticky;top:0;z-index:90}
    .header-inner{max-width:var(--ps-max);margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:14px 20px;gap:12px}
    .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
    .logo-mark{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--ps-accent),var(--ps-accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:18px;flex:0 0 56px}
    .brand-text{display:flex;flex-direction:column;line-height:1}
    .brand-text .title{font-weight:800;font-size:18px;color:var(--ps-brand)}
    .brand-text .tag{font-size:12px;color:var(--ps-muted)}
    nav.primary{display:flex;gap:12px;align-items:center}
    nav.primary a{padding:8px 12px;border-radius:8px;color:var(--ps-muted);font-weight:600;text-decoration:none}
    nav.primary a.active{background:rgba(0,102,255,0.06);color:var(--ps-accent-2)}
    .header-ctas{display:flex;gap:12px;align-items:center}
    .btn-primary{background:linear-gradient(90deg,var(--ps-accent),var(--ps-accent-2));color:#fff;padding:10px 14px;border-radius:10px;border:0;font-weight:700;cursor:pointer}

    /* Footer copied/adapted from provider-services */
    footer.site-footer{background:var(--ps-brand);color:#e6eefc;padding:48px 20px 36px;margin-top:36px}
    .footer-inner{max-width:var(--ps-max);margin:0 auto;display:grid;grid-template-columns:1fr 320px;gap:24px;align-items:start}
    .footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:36px}
    .footer-logo{height:60px;margin-bottom:10px;display:block}
    .footer-content h4{color:#e6eefc;font-size:16px;margin-bottom:8px}
    .footer-content p, .footer-content a{color:rgba(230,238,252,0.95);font-size:15px;line-height:1.6;margin:6px 0}
    .socials{display:flex;gap:12px}
    /* improved social icon visuals for contrast */
    .socials a{display:inline-flex;align-items:center;justify-content:center;width:var(--ps-social-size);height:var(--ps-social-size);border-radius:10px;color:#fff;text-decoration:none;box-shadow:0 8px 24px rgba(2,6,23,0.12);transition:transform .18s}
    .socials a svg{width:18px;height:18px;fill:#fff}
    .socials a.linkedin{background:#0A66C2}
    .socials a.twitter{background:#1DA1F2}
    .socials a.youtube{background:#FF0000}
    .socials a:hover{transform:translateY(-3px);box-shadow:0 14px 30px rgba(2,6,23,0.32)}
    .footer-newsletter{max-width:320px;text-align:right;color:rgba(230,238,252,0.9)}
    .footer-newsletter input{padding:10px;border-radius:8px;border:0;min-width:0;margin-right:8px}
    .footer-bottom{border-top:1px solid rgba(255,255,255,0.06);margin-top:24px;padding-top:18px;font-size:14px;color:rgba(230,238,252,0.75);text-align:center}

    .home-fab{position:fixed;right:18px;bottom:18px;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--ps-accent),var(--ps-accent-2));display:flex;align-items:center;justify-content:center;color:#fff;text-decoration:none;font-weight:800;box-shadow:0 12px 40px rgba(6,18,45,0.12)}

    @media (max-width:720px){ nav.primary{display:none} .logo-mark{width:48px;height:48px} .footer-newsletter{text-align:left}}
  </style>
</head>
<body>
  <div class="container">
    <!-- Header (provider-services style) - phone intentionally omitted on this page -->
    <header class="site-header" role="banner" aria-label="Main header">
      <div class="header-inner">
        <a href="index.html" class="brand" aria-label="Go to SamITHealth home page">
          <div class="logo-mark" aria-hidden="true">SH</div>
          <div class="brand-text">
            <div class="title">SamITHealth</div>
            <div class="tag">CMMI Level 5 • Healthcare IT & RCM</div>
          </div>
        </a>

        <nav class="primary" role="navigation" aria-label="Main navigation">
          <a href="index.html">Home</a>
          <a href="provider-services.html">Provider Services</a>
          <a href="payer-solutions.html">Payer Solutions</a>
          <a href="laboratory-services.html">Laboratory Services</a>
          <a href="what-makes-us-unique.html">Why Us</a>
          <a href="contact.html">Contact</a>
          <a href="Careers.html">Careers</a>
        </nav>

        <div class="header-ctas" aria-hidden="false">
          <button class="btn-primary" onclick="location.href='contact.html'">Request a Consultation</button>
        </div>
      </div>
    </header>

    <!-- preserve original page title and lead (now sits under the standardized header) -->
    <div style="display:flex;gap:14px;align-items:center;margin:18px 0">
      <div class="logo" aria-hidden="true" style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--navy),var(--teal));display:flex;align-items:center;justify-content:center;color:white;font-weight:700">SIH</div>
      <div>
        <h1>Form Conversion &amp; Interoperability — SamITHealth</h1>
        <p class="lead">Automated CMS-1500/UB-04 conversion, EDI mapping, and system harmonization for cleaner feeds.</p>
      </div>
    </div>

    <div class="grid">
      <main class="longlist">

        <section class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <h3>1. Conversion Volume & Success Rate (30d)</h3>
              <div class="muted">Total conversions, success %, and error trend</div>
            </div>
            <div class="controls">
              <select id="conv-range" class="small"><option value="30" selected>30d</option><option value="90">90d</option><option value="365">12mo</option></select>
              <button class="btn small" onclick="downloadCSV('conversion_volume')">CSV</button>
            </div>
          </div>
          <div class="viz"><canvas id="chart-conversion-volume"></canvas></div>
        </section>

        <section class="card">
          <h3>2. EDI Mapping Coverage</h3>
          <div class="muted">Fields mapped vs unmapped across common segments</div>
          <div class="viz"><canvas id="chart-mapping"></canvas></div>
        </section>

        <section class="card">
          <h3>3. Error Types (Long list)</h3>
          <div class="muted">Frequent parsing and validation errors requiring manual intervention</div>
          <div class="viz"><canvas id="chart-errors"></canvas></div>
        </section>

        <section class="card">
          <h3>4. System Harmonization Latency</h3>
          <div class="muted">Time from source submission to target system ingest</div>
          <div class="viz"><canvas id="chart-latency"></canvas></div>
        </section>

        <section class="card">
          <h3>5. Top Source Formats & Destinations</h3>
          <div class="muted">Which formats (PDF, EDI, XML) and targets see most activity</div>
          <div class="viz"><canvas id="chart-formats"></canvas></div>
        </section>

        <section class="card">
          <h3>6. Recent Conversion Jobs (Long list)</h3>
          <div class="muted">Latest jobs with status and quick actions</div>
          <div style="margin-top:8px;overflow:auto;max-height:240px">
            <table aria-label="Recent conversions">
              <thead><tr><th>Job ID</th><th>Source</th><th>Target</th><th>Status</th><th>Errors</th><th></th></tr></thead>
              <tbody id="recent-jobs-body"></tbody>
            </table>
          </div>
        </section>

      </main>

      <aside style="display:flex;flex-direction:column;gap:12px">
        <div class="card">
          <h3>Overview KPIs</h3>
          <div class="kpi-grid">
            <div class="kpi"><div class="value" id="kpi-jobs">—</div><div class="label">Jobs (30d)</div></div>
            <div class="kpi"><div class="value" id="kpi-success">—</div><div class="label">Success Rate</div></div>
            <div class="kpi"><div class="value" id="kpi-manual">—</div><div class="label">Manual Fixes</div></div>
            <div class="kpi"><div class="value" id="kpi-latency">—</div><div class="label">Avg Latency (s)</div></div>
          </div>
        </div>

        <div class="card">
          <h3>Top Mapping Issues</h3>
          <div class="muted">Fields requiring mapping review</div>
          <ol id="top-mapping-issues" style="margin-top:10px;padding-left:18px"></ol>
        </div>

        <div class="card">
          <h3>Connected Systems</h3>
          <div class="muted">Ingest and target endpoints with health status</div>
          <table style="margin-top:8px"><thead><tr><th>System</th><th>Status</th></tr></thead><tbody id="system-status"></tbody></table>
        </div>

        <div class="card">
          <h3>Actions</h3>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
            <button class="btn" onclick="simulateRefresh()">Refresh Data</button>
            <button class="btn" style="background:transparent;color:var(--navy);border:1px solid #e6eef2" onclick="openSettings()">Manage Mappings</button>
          </div>
        </div>

      </aside>
    </div>

    <!-- Footer: provider-services style (logo, links, socials, newsletter) -->
    <footer class="site-footer" role="contentinfo" aria-label="Footer">
      <div class="footer-inner">
        <div class="footer-content">
          <div>
            <a href="index.html" aria-label="SamITHealth home (logo)">
              <img class="footer-logo" src="https://images.unsplash.com/photo-1503676260728-1c00da094a0b?q=80&w=600&auto=format&fit=crop" alt="SamITHealth Logo">
            </a>
            <p>We provide comprehensive IT consultancy, software engineering, and healthcare technology services that enable enterprises to transform with confidence and measurable value.</p>
          </div>

          <div>
            <h4>Explore</h4>
            <a href="provider-services.html">Provider Services</a><br>
            <a href="payer-solutions.html">Payer Solutions</a><br>
            <a href="laboratory-services.html">Laboratory Services</a><br>
            <a href="consultancy.html">Consultancy</a>
          </div>
        </div>

        <div style="display:flex;flex-direction:column;gap:12px;align-items:flex-end">
          <nav class="socials" aria-label="Social media">
            <a class="linkedin" href="https://www.linkedin.com" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn — SamITHealth" title="LinkedIn">
              <svg viewBox="0 0 24 24" aria-hidden="true" role="img"><path d="M4.98 3.5C4.98 4.88 3.87 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM0 8h5v14H0V8zm7.5 0h4.7v1.9h.1c.7-1.2 2.5-2.5 5.1-2.5 5.5 0 6.5 3.6 6.5 8.3V22H22v-6.6c0-3.2-.1-7.3-4.5-7.3-2.2 0-3.6 1.2-4.2 2.1v-1.8H7.5V8z"/></svg>
            </a>

            <a class="twitter" href="https://twitter.com" target="_blank" rel="noopener noreferrer" aria-label="Twitter — SamITHealth" title="Twitter">
              <svg viewBox="0 0 24 24" aria-hidden="true" role="img"><path d="M22.46 6c-.77.35-1.6.58-2.46.69a4.3 4.3 0 0 0 1.88-2.37 8.6 8.6 0 0 1-2.72 1.04A4.28 4.28 0 0 0 12.07 9a12.14 12.14 0 0 1-8.82-4 4.28 4.28 0 0 0 1.32 5.72A4.25 4.25 0 0 1 2 9.7v.05a4.28 4.28 0 0 0 3.44 4.19c-.5.13-1.02.2-1.56.08a4.28 4.28 0 0 0 3.99 2.97A8.58 8.58 0 0 1 2 19.54a12.1 12.1 0 0 0 6.56 1.92c7.88 0 12.2-6.54 12.2-12.2v-.56A8.72 8.72 0 0 0 24 5.1a8.4 8.4 0 0 1-2.54.7z"/></svg>
            </a>

            <a class="youtube" href="https://youtube.com" target="_blank" rel="noopener noreferrer" aria-label="YouTube — SamITHealth" title="YouTube">
              <svg viewBox="0 0 24 24" aria-hidden="true" role="img"><path d="M23.5 6.2s-.2-1.7-.8-2.4c-.8-.9-1.7-.9-2.1-1C16.8 2.3 12 2.3 12 2.3s-4.8 0-8.5.5c-.4 0-1.3.1-2.1 1C.8 4.5.6 6.2.6 6.2S0 8 0 9.8v1.4C0 13.6.6 15.4.6 15.4s.2 1.7.8 2.4c.8.9 1.8.9 2.3 1.1 1.7.2 7.3.5 7.3.5s4.8 0 8.5-.5c.4 0 1.3-.1 2.1-1 .6-.7.8-2.4.8-2.4s.6-1.8.6-3.6v-1.4c0-1.8-.6-3.6-.6-3.6zM9.8 15.1V8.9l5.3 3.1-5.3 3.1z"/></svg>
            </a>
          </nav>

          <div class="footer-newsletter" aria-label="Newsletter sign up">
            <div>Subscribe to our newsletter for RCM, compliance, and health-tech insights.</div>
            <form style="margin-top:8px;display:flex;gap:8px;justify-content:flex-end" action="#" onsubmit="event.preventDefault();alert('Thanks — subscription demo (disabled).');">
              <input aria-label="Email address" placeholder="Email address" type="email" required>
              <button class="btn-primary" type="submit">Subscribe</button>
            </form>
          </div>
        </div>
      </div>

      <div class="footer-bottom">© 2025 SamITHealth. All rights reserved.</div>
    </footer>

    <!-- Floating quick-home button -->
    <a class="home-fab" href="index.html" aria-label="Back to home">SH</a>

    <!-- keep original small last-synced element to preserve page metadata -->
    <footer class="small-sync">
      Last synced: <span id="last-synced">—</span> · SamITHealth form conversion &amp; interoperability
    </footer>
  </div>

  <script>
    /* ======================
       ORIGINAL DATA + CHART SCRIPTS (preserved - logic and numbers unchanged)
       Note: I kept the same function names and behavior so nothing about the data flows changes.
       ====================== */

    const now = new Date();
    function genDays(days){
      const out=[];
      for(let i=days-1;i>=0;i--){
        const d=new Date();
        d.setDate(now.getDate()-i);
        const jobs = Math.round(80 + Math.random()*40);
        const success = Math.max(10, Math.round(jobs * (0.6 + Math.random()*0.35)));
        const errors = Math.max(0, jobs - success);
        const latency = Math.round(1 + Math.random()*10);
        out.push({date:d.toISOString().slice(0,10), jobs, success, errors, latency});
      }
      return out;
    }

    let convSeries = genDays(30);

    // Conversion volume chart
    const ctxV = document.getElementById('chart-conversion-volume').getContext('2d');
    const convChart = new Chart(ctxV,{
      type:'bar',
      data:{
        labels:convSeries.map(r=>r.date),
        datasets:[
          {label:'Jobs',data:convSeries.map(r=>r.jobs),backgroundColor:'rgba(0,102,255,0.75)'},
          {type:'line',label:'Success %',data:convSeries.map(r=>Math.round((r.success/r.jobs)*100)),borderColor:'rgba(4,120,87,0.9)',backgroundColor:'rgba(4,120,87,0.06)',tension:0.3}
        ]
      },
      options:{plugins:{legend:{position:'bottom'}},scales:{y:{beginAtZero:true}}}
    });

    // Mapping coverage (radar)
    const ctxM = document.getElementById('chart-mapping').getContext('2d');
    const segments=['Patient','Provider','Claim','Service','Diagnosis','Payer'];
    const mapped=[95,88,80,76,70,92];
    const mapChart = new Chart(ctxM,{type:'radar',data:{labels:segments,datasets:[{label:'% Mapped',data:mapped,backgroundColor:'rgba(0,102,255,0.08)',borderColor:'rgba(0,102,255,0.9)'}]},options:{scales:{r:{beginAtZero:true,max:100}}}});

    // Error types
    const ctxE = document.getElementById('chart-errors').getContext('2d');
    const etypes=['Missing NPI','Invalid DOB','Line-item mismatch','Unsupported code','Segment parse error','Payer reject'];
    const ecount=[42,28,35,18,26,14];
    const errChart = new Chart(ctxE,{type:'bar',data:{labels:etypes,datasets:[{label:'Count',data:ecount,backgroundColor:'rgba(220,38,38,0.7)'}]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}});

    // Latency
    const ctxL = document.getElementById('chart-latency').getContext('2d');
    const dates = convSeries.map(r=>r.date);
    const latencyChart = new Chart(ctxL,{type:'line',data:{labels:dates,datasets:[{label:'Avg Latency (s)',data:convSeries.map(r=>r.latency),borderColor:'rgba(0,102,255,0.85)',tension:0.25}]},options:{interaction:{mode:'index',intersect:false},plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}});

    // Formats
    const ctxF = document.getElementById('chart-formats').getContext('2d');
    const formats=['CMS-1500','UB-04','EDI 837','PDF','XML'];
    const fmtCount=[420,310,880,240,180];
    const fmtChart = new Chart(ctxF,{type:'bar',data:{labels:formats,datasets:[{label:'Count',data:fmtCount,backgroundColor:'rgba(0,102,255,0.75)'}]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}});

    // Recent jobs
    const statuses=['Success','Partial','Failed','Manual Review'];
    const recent = Array.from({length:18}).map((_,i)=>({id:`JC-${202800+i}`,source:['PDF','EDI','XML'][Math.floor(Math.random()*3)],target:['837','1500','UB-04'][Math.floor(Math.random()*3)],status:statuses[Math.floor(Math.random()*statuses.length)],errors:Math.round(Math.random()*5)}));
    function renderRecent(){
      const tbody=document.getElementById('recent-jobs-body');tbody.innerHTML='';
      recent.forEach(j=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td>${j.id}</td><td>${j.source}</td><td>${j.target}</td><td>${formatStatus(j.status)}</td><td>${j.errors}</td><td><button class="small" onclick="openJob('${j.id}')">Open</button></td>`;
        tbody.appendChild(tr);
      });
    }
    function formatStatus(s){
      if(s==='Success')return '<span class="badge ok">Success</span>';
      if(s==='Failed')return '<span class="badge err">Failed</span>';
      if(s==='Partial')return '<span class="badge warn">Partial</span>';
      return '<span class="badge warn">Manual Review</span>';
    }

    // System status
    const systems = [{name:'Ingest API',status:'OK'},{name:'Mapping Engine',status:'OK'},{name:'EDI Gateway',status:'Degraded'},{name:'Target Queue',status:'OK'}];
    function renderSystems(){const tbody=document.getElementById('system-status');tbody.innerHTML='';systems.forEach(s=>{const tr=document.createElement('tr');const st = s.status==='OK'?'<span class="badge ok">OK</span>':'<span class="badge warn">Degraded</span>';tr.innerHTML=`<td>${s.name}</td><td>${st}</td>`;tbody.appendChild(tr)})}

    // Top mapping issues
    const topIssues=['NPI variants','Missing taxonomy','Unmapped CPT subfields','Date formats','Payer-specific loops'];
    function renderTopIssues(){const ol=document.getElementById('top-mapping-issues');ol.innerHTML='';topIssues.forEach(i=>{const li=document.createElement('li');li.textContent=i;ol.appendChild(li)})}

    // KPIs
    function renderKPIs(){
      const jobs = convSeries.reduce((a,b)=>a+b.jobs,0);
      const success = Math.round(convSeries.reduce((a,b)=>a+b.success,0)/convSeries.length);
      const manual = Math.round(convSeries.reduce((a,b)=>a+b.errors,0)/convSeries.length);
      const avgLatency = Math.round(convSeries.reduce((a,b)=>a+b.latency,0)/convSeries.length);
      document.getElementById('kpi-jobs').textContent = jobs.toLocaleString();
      document.getElementById('kpi-success').textContent = success + '%';
      document.getElementById('kpi-manual').textContent = manual.toLocaleString();
      document.getElementById('kpi-latency').textContent = avgLatency;
    }

    function setSynced(){document.getElementById('last-synced').textContent = new Date().toLocaleString()}

    function simulateRefresh(){
      convSeries.forEach(s=>{s.jobs = Math.max(20, s.jobs + Math.round((Math.random()-0.4)*20)); s.success = Math.max(10, Math.round(s.jobs*(0.6 + Math.random()*0.35))); s.errors = Math.max(0, s.jobs - s.success); s.latency = Math.max(1, Math.round(s.latency * (0.9 + Math.random()*0.2)));});
      convChart.data.labels = convSeries.map(r=>r.date);
      convChart.data.datasets[0].data = convSeries.map(r=>r.jobs);
      convChart.data.datasets[1].data = convSeries.map(r=>Math.round((r.success/r.jobs)*100));
      convChart.update();
      latencyChart.data.datasets[0].data = convSeries.map(r=>r.latency); latencyChart.update();
      errChart.data.datasets[0].data = ecount.map(e=>Math.max(5, e + Math.round((Math.random()-0.5)*20))); errChart.update();
      renderRecent();renderSystems();renderTopIssues();renderKPIs();setSynced();
    }

    function openJob(id){alert('Open job: '+id+' — opens job detail in product')}
    function openSettings(){alert('Open mapping manager — configure templates, conversions and rules')}

    function downloadCSV(key){
      let csv='';
      if(key==='conversion_volume'){
        csv='date,jobs,success,errors,latency\n'+convSeries.map(s=>`${s.date},${s.jobs},${s.success},${s.errors},${s.latency}`).join('\n');
      }
      const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url;
      a.download=(key||'data')+'.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    // initial render
    renderRecent();renderSystems();renderTopIssues();renderKPIs();setSynced();

    // date-range selector
    document.getElementById('conv-range').addEventListener('change',(e)=>{
      const days = parseInt(e.target.value,10);
      convSeries = genDays(days);
      convChart.data.labels = convSeries.map(r=>r.date);
      convChart.data.datasets[0].data = convSeries.map(r=>r.jobs);
      convChart.data.datasets[1].data = convSeries.map(r=>Math.round((r.success/r.jobs)*100));
      convChart.update();
      renderKPIs();
      setSynced();
    });
  </script>

  <script>
    // Footer newsletter demo intercept (keeps behavior identical to provider-services)
    document.querySelectorAll('.site-footer form[action="#"], .site-footer form[action=""]').forEach(f => f.addEventListener('submit', function(e){ e.preventDefault(); alert('Thanks — subscription demo (disabled).'); }));

    // handy keyboard shortcut 'h' to go home
    document.addEventListener('keydown', function(e){ if((e.key === 'h' || e.key === 'H') && !e.metaKey && !e.ctrlKey && !e.altKey) window.location.href='index.html'; });
  </script>
</body>
</html>